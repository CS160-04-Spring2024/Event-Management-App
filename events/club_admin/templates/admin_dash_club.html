{% extends 'homebase.html' %}
{% block content %}

<div class="purple-bg">
    <!-- white overlay for content -->
    <div class="row justify-content-center" style="padding-top: 1rem">
        <div class="col-md-7">
            <div class="card " style="border-radius: 37px;">
                <div class="card-header text-center">{{club}} Events</div>
                <hr>
                <!-- col/card begins -->
                    <div class="container">
                        <a href="{% url 'createEvent' %}">
                            <button type="button" class="btn btn-outline-warning rounded-pill" style="margin: auto;">
                                Create an Event
                            </button>
                        </a>
                        <hr>
                        <div class="row">
                            {% for event in events %}
                            <div class="col my-2">
                                <div class="card shadow" style="width: 18rem; height: 18rem; border-radius: 10%;">
                                    <div class="card-body py-2">
                                        <a href="{% url 'event' event_id=event.event_id %}" class="" style="text-decoration: none;"><h4 class="card-subtitle mb-2 text-muted">{{event.event_name}}</h4></a>
                                        <div class="col d-flex">
                                            <i class="bi bi-person mx-2"></i>
                                            <p class="">{{event.mode_of_operation}}</p>
                                        </div>
                                        <div class="col d-flex">
                                            <i class="bi bi-clock mx-1"></i>
                                            <p class="" style="font-size: small;">{{event.start_time}} - 
                                            <p class="" style="font-size: small;">{{event.end_time}}</p>                                        </div>
                                        <hr>
                                        <!-- Inside the loop for listing events -->
                                        <div class="justify-content-center" style="margin: auto; width: 75%;">
                                            <a href="{% url 'editEvent' club=club event_id=event.event_id %}" class="" style="text-decoration: none;">
                                                <button type="button" class="btn btn-outline-warning rounded-pill" style="width: 25vh; margin: auto;">
                                                    Edit Event
                                                </button>
                                            </a>
                                            <br>
                                            <form method="POST" action="{% url 'deleteEvent' club=club event_id=event.event_id %}" class="mt-2">
                                                {% csrf_token %}
                                                <button type="submit" class="btn btn-outline-warning rounded-pill delete-event-button" style="width: 25vh; margin: auto;">Delete Event</button>
                                            </form>   
                                        </div>                             
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        <hr>
                        <a href="{% url 'adminDash' %}"><button type="submit" class="btn btn-outline-warning rounded-pill" style="width: 25vh;">Go back</button></a>
                    </div>
                <div class="card-body"></div>
            </div>
        </div>
    </div>
</div>

<script>
    // Add event listener to delete event buttons
    const deleteButtons = document.querySelectorAll('.delete-event-button');
    deleteButtons.forEach(button => {
        button.addEventListener('click', (event) => {
            // Stop propagation to prevent clicking on the card
            event.stopPropagation();
        });
    });
</script>

{% endblock %}
