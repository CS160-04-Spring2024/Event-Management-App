{% extends 'homebase.html' %}
{% block content %}

<div class="purple-bg">
    <!-- white overlay for content -->
    <div class="row justify-content-center" style="padding-top: 1rem">
        <div class="col-md-7">
            <div class="card " style="border-radius: 37px;">
                <div class="card-header text-center">{{club}} Events</div>
                <hr>
                <!-- col/card begins -->
                    <div class="container">
                        <a href="{% url 'createEvent' %}">
                            <button type="button" class="btn btn-outline-warning rounded-pill" style="width: 120vh;">
                                Create an Event
                            </button>
                        </a>
                        <hr>
                        <div class="row">
                            {% for event in events %}
                            <div class="col">
                                <div class="card position-relative shadow" style="width: 18rem; height: fit-content; border-radius: 10%; margin: auto; padding-bottom: 2vh;">
                                    <div class="card-body">
                                        <h4 class="card-subtitle mb-2 text-muted">{{event.event_name}}</h4>
                                        <div class="col d-flex">
                                            <i class="bi bi-person mx-2"></i>
                                            <p class="">{{event.mode_of_operation}}</p>
                                        </div>
                                        <div class="col d-flex">
                                            <i class="bi bi-clock mx-1"></i>
                                            <p class="" style="font-size: small;">{{event.start_time}} - 
                                            <p class="" style="font-size: small;">{{event.end_time}}</p>                                        </div>
                                        <hr>
                                        <a href="{% url 'event' event_id=event.event_id %}" class=""
                                            style="text-decoration: none;">{{event.attendees}} people registered</a>
                                        <a href="" class="" style="text-decoration: none;"></a>
                                        <!--select club, render page with the events of that club-->
                                    </div>
                                    <!-- Inside the loop for listing events -->
                                    <div>
                                        <a href="{% url 'editEvent' club=club event_id=event.event_id %}" class="" style="text-decoration: none;">
                                            <button type="button" class="btn btn-outline-warning rounded-pill" style="width: 25vh; margin: auto;">
                                                Edit Event
                                            </button>
                                        </a>
                                        <br>
                                        <form method="POST" action="{% url 'deleteEvent' club=club event_id=event.event_id %}">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-outline-warning rounded-pill delete-event-button" style="width: 25vh; margin: auto;">Delete Event</button>
                                        </form>   
                                    </div>                             
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        <hr>
                        <a href="{% url 'adminDash' %}"><button type="submit" class="btn btn-outline-warning rounded-pill" style="width: 25vh;">Go back</button></a>
                    </div>
                <div class="card-body"></div>
            </div>
        </div>
    </div>
</div>

<script>
    // Add event listener to delete event buttons
    const deleteButtons = document.querySelectorAll('.delete-event-button');
    deleteButtons.forEach(button => {
        button.addEventListener('click', (event) => {
            // Stop propagation to prevent clicking on the card
            event.stopPropagation();
        });
    });
</script>

{% endblock %}
